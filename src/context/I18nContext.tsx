import { createContext, useContext } from "react";
import type { ReactNode } from "react";

export type Language = "de" | "en";

type I18nContextValue = {
  language: Language;
  t: (key: string) => string;
};

const I18nContext = createContext<I18nContextValue>({
  language: "de",
  t: (key) => key,
});

export const translations: Record<Language, Record<string, string>> = {
  de: {
    "app.title": "Learning Board",
    "app.currentView": "Aktuelle Ansicht",
    "app.newStep": "Neuer Step",
    "app.connected": "✓ Verbunden",
    "app.notConnected": "✗ Nicht verbunden",
    "app.commandHint": "Tipp: Mit ⌘K / Ctrl+K oeffnest du die Command Palette.",
    "app.toggleTheme": "Theme umschalten",
    "nav.title": "Navigation",
    "nav.close": "Schliessen",
    "nav.dashboard": "Dashboard",
    "nav.steps": "Lernschritte",
    "nav.focus": "Fokus",
    "nav.chat": "Chat",
    "nav.stats": "Statistiken",
    "nav.settings": "Einstellungen",
    "nav.deep": "Deep Learning",
    "steps.addPlaceholder": "Neuen Lernschritt hinzufuegen...",
    "steps.addButton": "Hinzufuegen",
    "steps.filterPlaceholder": "Nach Titel, Tags oder Notizen filtern...",
    "steps.allTags": "Alle Tags",
    "steps.empty": "Noch keine Lernschritte vorhanden.",
    "steps.emptyFiltered": "Keine Treffer fuer die aktuelle Suche.",
    "steps.delete": "Loeschen",
    "focus.empty": "Fuege einen Lernschritt hinzu, um zu starten.",
    "focus.createdAt": "Erstellt am",
    "focus.tags": "Tags",
    "focus.tagsPlaceholder": "z.B. KI, Mathe, Review",
    "focus.timeLabel": "Lernzeit",
    "focus.start": "Start",
    "focus.pause": "Pause",
    "focus.reset": "Reset",
    "focus.notesLabel": "Notizen",
    "focus.notesPlaceholder": "Halte deine Erkenntnisse fest...",
    "focus.quickNotes": "Quick Notes",
    "focus.quickNotesPlaceholder": "Kurze Notiz hinzufuegen...",
    "focus.quickNotesEmpty": "Noch keine Quick Notes.",
    "focus.sessions": "Session-Timeline",
    "focus.sessionsEmpty": "Noch keine Sessions.",
    "chat.title": "Lernassistent",
    "chat.context": "Kontext",
    "chat.empty": "Starte eine Unterhaltung zu deinem aktuellen Thema.",
    "chat.loading": "Antwort wird vorbereitet",
    "chat.jumpToEnd": "Zum Ende springen",
    "chat.noKey": "Bitte hinterlege deinen API-Key in den Einstellungen.",
    "chat.general": "Allgemeines Lernen",
    "chat.placeholder": "Formuliere deine Frage oder bitte um eine kurze Erklaerung...",
    "chat.send": "Senden",
    "stats.heatmapTitle": "Aktivitaet der letzten 7 Tage",
    "dashboard.focusTitle": "Aktueller Fokus",
    "dashboard.focusEmpty": "Kein aktiver Lernschritt. Erstelle einen neuen Schritt.",
    "dashboard.focusButton": "Zum Fokus wechseln",
    "dashboard.collected": "gesammelt",
    "dashboard.today": "Heute",
    "dashboard.totalSinceStart": "Gesamtzeit seit Start",
    "dashboard.statsButton": "Zu den Statistiken",
    "dashboard.recentSteps": "Letzte Lernschritte",
    "dashboard.allSteps": "Alle Lernschritte anzeigen",
    "deep.title": "Deep Learning",
    "deep.subtitle": "Fokusmodus mit animiertem Sonnenuntergang und Musik",
    "deep.theme": "Designstil",
    "deep.theme.cinematic": "Cinematic Sunset",
    "deep.theme.neon": "Neon-Night Tech",
    "deep.theme.minimal": "Minimal Calm",
    "deep.theme.aurora": "Aurora Learning",
    "deep.theme.ocean": "Ocean Breeze",
    "deep.music": "Musik",
    "deep.play": "Abspielen",
    "deep.pause": "Pausieren",
    "deep.volume": "Lautstaerke",
    "deep.note": "Tipp: Klicke erst auf Abspielen, um die Musik zu starten.",
    "deep.fullscreen": "Vollbild",
    "deep.exitFullscreen": "Schliessen",
    "command.title": "Command Palette",
    "command.search": "Aktion suchen...",
    "command.empty": "Keine Aktion gefunden.",
    "dialog.newStepTitle": "Neuer Lernschritt",
    "dialog.newStepHint": "Gib einen klaren, kurzen Titel an.",
    "dialog.create": "Erstellen",
    "dialog.cancel": "Abbrechen",
    "dialog.importTitle": "Import Vorschau",
    "dialog.importHint": "Bitte pruefe die Inhalte, bevor du ueberschreibst.",
    "dialog.importReplace": "Der Import ersetzt deine aktuellen lokalen Daten.",
    "dialog.importSteps": "Steps",
    "dialog.importSessions": "Sessions",
    "dialog.importChat": "Chat",
    "dialog.import": "Importieren",
    "settings.title": "Einstellungen",
    "settings.apiKey": "API Key",
    "settings.apiKeyHint": "Dein API-Key bleibt lokal gespeichert und wird nie gesendet.",
    "settings.save": "Speichern",
    "settings.show": "Anzeigen",
    "settings.hide": "Verbergen",
    "settings.unsaved": "Nicht gespeichert",
    "settings.profile": "Chat Profil",
    "settings.profileHint": "Beeinflusst System-Prompt fuer Antworten.",
    "settings.profileShort": "Kurz & praegnant",
    "settings.profileDetail": "Detail & strukturiert",
    "settings.profileQuiz": "Quiz-Modus",
    "settings.context": "Kontextfenster",
    "settings.contextHint": "Anzahl vorheriger Nachrichten im Kontext.",
    "settings.exportImport": "Export / Import",
    "settings.exportJson": "JSON Export",
    "settings.exportMd": "Markdown Export",
    "settings.exportChat": "Chat Export",
    "settings.importJson": "JSON Import",
    "settings.backup": "Automatisches Backup",
    "settings.backupHint": "Backup-Intervall (Minuten)",
    "settings.backupDownload": "Backup herunterladen",
    "settings.quickNotes": "Quick Notes",
    "settings.chatHistory": "Chat Verlauf",
    "settings.chatClear": "Chat leeren",
    "settings.language": "Sprache",
  },
  en: {
    "app.title": "Learning Board",
    "app.currentView": "Current view",
    "app.newStep": "New step",
    "app.connected": "✓ Connected",
    "app.notConnected": "✗ Not connected",
    "app.commandHint": "Tip: Use ⌘K / Ctrl+K to open the command palette.",
    "app.toggleTheme": "Toggle theme",
    "nav.title": "Navigation",
    "nav.close": "Close",
    "nav.dashboard": "Dashboard",
    "nav.steps": "Learning steps",
    "nav.focus": "Focus",
    "nav.chat": "Chat",
    "nav.stats": "Stats",
    "nav.settings": "Settings",
    "nav.deep": "Deep Learning",
    "steps.addPlaceholder": "Add a new learning step...",
    "steps.addButton": "Add",
    "steps.filterPlaceholder": "Filter by title, tags, or notes...",
    "steps.allTags": "All tags",
    "steps.empty": "No learning steps yet.",
    "steps.emptyFiltered": "No results for the current search.",
    "steps.delete": "Delete",
    "focus.empty": "Add a learning step to get started.",
    "focus.createdAt": "Created at",
    "focus.tags": "Tags",
    "focus.tagsPlaceholder": "e.g. AI, Math, Review",
    "focus.timeLabel": "Study time",
    "focus.start": "Start",
    "focus.pause": "Pause",
    "focus.reset": "Reset",
    "focus.notesLabel": "Notes",
    "focus.notesPlaceholder": "Capture your insights...",
    "focus.quickNotes": "Quick notes",
    "focus.quickNotesPlaceholder": "Add a quick note...",
    "focus.quickNotesEmpty": "No quick notes yet.",
    "focus.sessions": "Session timeline",
    "focus.sessionsEmpty": "No sessions yet.",
    "chat.title": "Learning assistant",
    "chat.context": "Context",
    "chat.empty": "Start a conversation about your topic.",
    "chat.loading": "Preparing an answer",
    "chat.jumpToEnd": "Jump to bottom",
    "chat.noKey": "Please add your API key in settings.",
    "chat.general": "General learning",
    "chat.placeholder": "Ask a question or request a short explanation...",
    "chat.send": "Send",
    "stats.heatmapTitle": "Activity over the last 7 days",
    "dashboard.focusTitle": "Current focus",
    "dashboard.focusEmpty": "No active step. Create a new one.",
    "dashboard.focusButton": "Go to focus",
    "dashboard.collected": "collected",
    "dashboard.today": "Today",
    "dashboard.totalSinceStart": "Total since start",
    "dashboard.statsButton": "Go to stats",
    "dashboard.recentSteps": "Recent steps",
    "dashboard.allSteps": "Show all steps",
    "deep.title": "Deep Learning",
    "deep.subtitle": "Focus mode with an animated sunset and music",
    "deep.theme": "Design style",
    "deep.theme.cinematic": "Cinematic Sunset",
    "deep.theme.neon": "Neon-Night Tech",
    "deep.theme.minimal": "Minimal Calm",
    "deep.theme.aurora": "Aurora Learning",
    "deep.theme.ocean": "Ocean Breeze",
    "deep.music": "Music",
    "deep.play": "Play",
    "deep.pause": "Pause",
    "deep.volume": "Volume",
    "deep.note": "Tip: Click Play first to start the music.",
    "deep.fullscreen": "Fullscreen",
    "deep.exitFullscreen": "Close",
    "command.title": "Command Palette",
    "command.search": "Search actions...",
    "command.empty": "No actions found.",
    "dialog.newStepTitle": "New learning step",
    "dialog.newStepHint": "Provide a clear, short title.",
    "dialog.create": "Create",
    "dialog.cancel": "Cancel",
    "dialog.importTitle": "Import preview",
    "dialog.importHint": "Review the content before replacing.",
    "dialog.importReplace": "Import will replace your local data.",
    "dialog.importSteps": "Steps",
    "dialog.importSessions": "Sessions",
    "dialog.importChat": "Chat",
    "dialog.import": "Import",
    "settings.title": "Settings",
    "settings.apiKey": "API Key",
    "settings.apiKeyHint": "Your API key is stored locally and never sent elsewhere.",
    "settings.save": "Save",
    "settings.show": "Show",
    "settings.hide": "Hide",
    "settings.unsaved": "Not saved",
    "settings.profile": "Chat profile",
    "settings.profileHint": "Controls the system prompt.",
    "settings.profileShort": "Short & concise",
    "settings.profileDetail": "Detailed & structured",
    "settings.profileQuiz": "Quiz mode",
    "settings.context": "Context window",
    "settings.contextHint": "Number of previous messages to include.",
    "settings.exportImport": "Export / Import",
    "settings.exportJson": "Export JSON",
    "settings.exportMd": "Export Markdown",
    "settings.exportChat": "Export chat",
    "settings.importJson": "Import JSON",
    "settings.backup": "Automatic backup",
    "settings.backupHint": "Backup interval (minutes)",
    "settings.backupDownload": "Download backup",
    "settings.quickNotes": "Quick notes",
    "settings.chatHistory": "Chat history",
    "settings.chatClear": "Clear chat",
    "settings.language": "Language",
  },
};

export const createTranslator = (language: Language) => (key: string) =>
  translations[language]?.[key] ?? key;

export const I18nProvider = ({
  language,
  children,
}: {
  language: Language;
  children: ReactNode;
}) => {
  const t = (key: string) => translations[language]?.[key] ?? key;
  return (
    <I18nContext.Provider value={{ language, t }}>
      {children}
    </I18nContext.Provider>
  );
};

export const useI18n = () => useContext(I18nContext);
